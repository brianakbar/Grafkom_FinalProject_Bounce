(()=>{"use strict";var e,t={6330:(e,t,r)=>{const o=r(6601),i=r(7093);let n=new Array;n.push(new o.BallPrefab),n.push(new o.FloorPrefab),new i.GameWorld(n)},2508:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerController=void 0;var o=r(4999);Object.defineProperty(t,"PlayerController",{enumerable:!0,get:function(){return o.PlayerController}})},4999:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerController=void 0;const o=r(293),i=r(7158);let n=!1,s=!1,a=!1,d=!1,c=!1;class PlayerController extends o.Component{constructor(){super(...arguments),this.awake=()=>{document.addEventListener("keydown",this.onKeyDown,!1),document.addEventListener("keyup",this.onKeyUp,!1),this.mover=this.getComponent(i.Mover)},this.update=()=>{null!=this.mover&&(n?this.mover.startMove(i.MoveDirection.Forward):a?this.mover.startMove(i.MoveDirection.Backward):this.mover.stopMove(),d?this.mover.startRotate(i.RotateDirection.Right):s?this.mover.startRotate(i.RotateDirection.Left):this.mover.stopRotate(),c&&(this.mover.jump(),c=!1))}}onKeyDown(e){"w"==e.key?n=!0:"s"==e.key?a=!0:"a"==e.key?s=!0:"d"==e.key?d=!0:" "==e.key&&(c=!0)}onKeyUp(e){"w"==e.key?n=!1:"s"==e.key?a=!1:"a"==e.key?s=!1:"d"==e.key&&(d=!1)}}t.PlayerController=PlayerController},293:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Transform=t.Time=t.GameObject=t.EventManager=t.Component=void 0;var o=r(8755);Object.defineProperty(t,"Component",{enumerable:!0,get:function(){return o.Component}});var i=r(4309);Object.defineProperty(t,"EventManager",{enumerable:!0,get:function(){return i.EventManager}});var n=r(6350);Object.defineProperty(t,"GameObject",{enumerable:!0,get:function(){return n.GameObject}});var s=r(5646);Object.defineProperty(t,"Time",{enumerable:!0,get:function(){return s.Time}});var a=r(1086);Object.defineProperty(t,"Transform",{enumerable:!0,get:function(){return a.Transform}})},8755:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;const o=r(293);t.Component=class Component{constructor(){this.gameObject=new o.GameObject,this.awake=()=>{},this.start=()=>{},this.update=()=>{}}setup(e){this.gameObject=e,o.EventManager.getSystem().subscribe("Awake",this.awake),o.EventManager.getSystem().subscribe("Start",this.start),o.EventManager.getSystem().subscribe("Update",this.update)}getComponent(e){return this.gameObject.getComponent(e)}getRenderObject(){return this.gameObject.getRenderObject()}getPhysicBody(){return this.gameObject.getPhysicBody()}}},4309:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventManager=void 0;const o=r(8675);t.EventManager=class EventManager{static getSystem(){return this.eventSystem||(this.eventSystem=new o.default),this.eventSystem}}},6350:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GameObject=void 0;const o=r(5232),i=r(3687),n=r(293);t.GameObject=class GameObject{constructor(){this.name="GameObject",this.mesh=new o.Mesh,this.rigidBody=new i.Body,this.components=new Array,this.awake=()=>{},this.start=()=>{},this.update=()=>{},this.updateBody=()=>{this.mesh&&this.rigidBody&&(this.mesh.position.set(this.rigidBody.position.x,this.rigidBody.position.y,this.rigidBody.position.z),this.mesh.quaternion.set(this.rigidBody.quaternion.x,this.rigidBody.quaternion.y,this.rigidBody.quaternion.z,this.rigidBody.quaternion.w))}}setup(){this.create(),n.EventManager.getSystem().subscribe("Awake",this.awake),n.EventManager.getSystem().subscribe("Start",this.start),n.EventManager.getSystem().subscribe("Update",this.update),n.EventManager.getSystem().subscribe("Update",this.updateBody)}getRenderObject(){return this.mesh}getPhysicBody(){return this.rigidBody}getTransform(){return this.transform}getComponent(e){let t=null;return this.components.forEach((r=>{r.constructor.name===e.name&&(t=r)})),t||null}addComponent(e){e.setup(this),this.components.push(e)}draw(){}create(){}}},5646:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Time=void 0;class Time{}t.Time=Time,Time.deltaTime=0},1086:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Transform=void 0;const o=r(5232),i=r(293);class Transform extends i.Component{constructor(){super(...arguments),this.position=new o.Vector3,this.rotation=new o.Quaternion}}t.Transform=Transform},7158:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RotateDirection=t.Mover=t.MoveDirection=void 0;var o=r(1193);Object.defineProperty(t,"MoveDirection",{enumerable:!0,get:function(){return o.MoveDirection}});var i=r(8598);Object.defineProperty(t,"Mover",{enumerable:!0,get:function(){return i.Mover}});var n=r(4505);Object.defineProperty(t,"RotateDirection",{enumerable:!0,get:function(){return n.RotateDirection}})},1193:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MoveDirection=void 0,function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward",e[e.None=0]="None"}(t.MoveDirection||(t.MoveDirection={}))},8598:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Mover=void 0;const o=r(9542),i=r(293),n=r(7158);class Mover extends i.Component{constructor(){super(...arguments),this.acceleration=20,this.deceleration=2,this.maxSpeed=20,this.rotateSpeed=90,this.jumpForce=20,this.angle=Math.PI/2,this.currentSpeed=0,this.moveDirection=n.MoveDirection.None,this.rotateDirection=n.RotateDirection.None,this.awake=()=>{this.rigidBody=this.getPhysicBody()},this.update=()=>{this.move(),this.rotate()}}startMove(e){this.moveDirection=e}stopMove(){this.moveDirection=n.MoveDirection.None}startRotate(e){this.rotateDirection=e}stopRotate(){this.rotateDirection=n.RotateDirection.None}jump(){this.rigidBody.velocity.y=this.jumpForce}move(){this.moveDirection==n.MoveDirection.Forward?this.currentSpeed=(0,o.clamp)(this.currentSpeed+this.acceleration*i.Time.deltaTime,this.currentSpeed,this.maxSpeed):this.moveDirection==n.MoveDirection.Backward?this.currentSpeed=(0,o.clamp)(this.currentSpeed-this.acceleration*i.Time.deltaTime,-this.maxSpeed,this.currentSpeed):this.currentSpeed>0?this.currentSpeed=(0,o.clamp)(this.currentSpeed-this.deceleration*i.Time.deltaTime,0,this.currentSpeed):this.currentSpeed=(0,o.clamp)(this.currentSpeed+this.deceleration*i.Time.deltaTime,this.currentSpeed,0);var e=this.currentSpeed*Math.sin(this.angle),t=this.currentSpeed*Math.cos(this.angle);this.rigidBody.velocity.z=e,this.rigidBody.velocity.x=t}rotate(){this.angle+=this.rotateDirection*Math.PI/180*Math.abs(this.currentSpeed/this.maxSpeed)*this.rotateSpeed*i.Time.deltaTime}}t.Mover=Mover},4505:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RotateDirection=void 0,function(e){e[e.Right=1]="Right",e[e.Left=-1]="Left",e[e.None=0]="None"}(t.RotateDirection||(t.RotateDirection={}))},6601:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FloorPrefab=t.BallPrefab=void 0;var o=r(8744);Object.defineProperty(t,"BallPrefab",{enumerable:!0,get:function(){return o.BallPrefab}});var i=r(4483);Object.defineProperty(t,"FloorPrefab",{enumerable:!0,get:function(){return i.FloorPrefab}})},8744:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BallPrefab=void 0;const o=r(5232),i=r(3687),n=r(5264),s=r(293),a=r(2508),d=r(7158);class BallPrefab extends s.GameObject{constructor(){super(...arguments),this.name="BallPrefab",this.radius=3,this.update=()=>{}}create(){this.draw(),this.addComponents()}draw(){let e=new o.SphereGeometry(this.radius),t=new o.MeshBasicMaterial({color:13697024});this.mesh=new o.Mesh(e,t);let r=n.threeToCannon(this.mesh);this.rigidBody=new i.Body({mass:20,shape:null==r?void 0:r.shape,position:null==r?void 0:r.offset,quaternion:null==r?void 0:r.orientation}),this.rigidBody.position.set(0,1,0)}addComponents(){this.addComponent(new a.PlayerController),this.addComponent(new d.Mover)}}t.BallPrefab=BallPrefab},4483:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FloorPrefab=void 0;const o=r(5232),i=r(3687),n=r(5264),s=r(293);class FloorPrefab extends s.GameObject{constructor(){super(...arguments),this.name="FloorPrefab"}create(){this.draw()}draw(){let e=new o.BoxGeometry(50,5,50),t=new o.MeshBasicMaterial({color:9849600});this.mesh=new o.Mesh(e,t),this.mesh.position.set(0,-5,0);let r=n.threeToCannon(this.mesh);this.rigidBody=new i.Body({type:i.Body.STATIC,shape:null==r?void 0:r.shape,position:null==r?void 0:r.offset,quaternion:null==r?void 0:r.orientation}),this.rigidBody.position.set(0,-5,0)}}t.FloorPrefab=FloorPrefab},7093:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GameWorld=void 0;var o=r(3626);Object.defineProperty(t,"GameWorld",{enumerable:!0,get:function(){return o.GameWorld}})},3626:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GameWorld=void 0;const o=r(3687),i=r(5232),n=r(293),s=r(3094);t.GameWorld=class GameWorld{constructor(e){this.camera=new i.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e3),this.renderWorld=new i.Scene,this.physicWorld=new o.World({gravity:new o.Vec3(0,-20,0)}),this.renderer=new i.WebGLRenderer,this.lastTime=0,this.update=e=>{requestAnimationFrame(this.update),n.Time.deltaTime=(e-this.lastTime)/1e3,this.lastTime=e,this.control.update(),this.physicWorld.fixedStep(),this.renderer.render(this.renderWorld,this.camera),n.EventManager.getSystem().notify("Update")},this.camera.position.z=25,this.initRenderWorld(),this.initPhysicWorld(),this.initRenderer(),document.body.appendChild(this.renderer.domElement),this.control=new s.OrbitControls(this.camera,this.renderer.domElement),this.control.update(),e.forEach((e=>{this.add(e)})),n.EventManager.getSystem().notify("Awake"),n.EventManager.getSystem().notify("Start"),requestAnimationFrame(this.update)}add(e){e.setup(),this.renderWorld.add(e.getRenderObject()),this.physicWorld.addBody(e.getPhysicBody())}initRenderWorld(){this.renderWorld.fog=new i.Fog(0,500,1e4);const e=new i.AxesHelper(5);this.renderWorld.add(e)}initPhysicWorld(){this.physicWorld.defaultContactMaterial.restitution=.5}initRenderer(){this.renderer.setSize(window.innerWidth,window.innerHeight),null!=this.renderWorld.fog&&this.renderer.setClearColor(this.renderWorld.fog.color),this.renderer.outputEncoding=i.sRGBEncoding}}}},r={};function o(e){var i=r[e];if(void 0!==i)return i.exports;var n=r[e]={exports:{}};return t[e].call(n.exports,n,n.exports,o),n.exports}o.m=t,e=[],o.O=(t,r,i,n)=>{if(!r){var s=1/0;for(h=0;h<e.length;h++){for(var[r,i,n]=e[h],a=!0,d=0;d<r.length;d++)(!1&n||s>=n)&&Object.keys(o.O).every((e=>o.O[e](r[d])))?r.splice(d--,1):(a=!1,n<s&&(s=n));if(a){e.splice(h--,1);var c=i();void 0!==c&&(t=c)}}return t}n=n||0;for(var h=e.length;h>0&&e[h-1][2]>n;h--)e[h]=e[h-1];e[h]=[r,i,n]},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var i,n,[s,a,d]=r,c=0;if(s.some((t=>0!==e[t]))){for(i in a)o.o(a,i)&&(o.m[i]=a[i]);if(d)var h=d(o)}for(t&&t(r);c<s.length;c++)n=s[c],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(h)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var i=o.O(void 0,[491],(()=>o(6330)));i=o.O(i)})();